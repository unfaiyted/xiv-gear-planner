!function(t){function e(r){if(n[r])return n[r].exports;var a=n[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,e),a.l=!0,a.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=10)}([function(t,e,n){"use strict";t.exports={settings:{url:"/api/",rateLimit:5,token:$("meta[name='_csrf']").attr("content"),header:$("meta[name='_csrf_header']").attr("content")},addData:function(e,n){return e=void 0!==e?e:"",fetch(e,{method:"post",credentials:"same-origin",headers:{"X-CSRF-Token":t.exports.settings.token,Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)}).then(function(t){return t.json()})},deleteData:function(e,n){return t.exports.addData(e,n)},getData:function(e,n,r){return n=void 0!==n?n:"",r=void 0!==r?r:"",fetch(t.exports.settings.url+e+"/"+n+r).then(function(t){return t.json()})}}},,,,,,,,,,function(t,e,n){"use strict";var r=n(11),a=n(0),s=a.addData,o=n(12),i=o.toPlayerObj;t.exports={settings:{minLength:3,userInput:$("#user-input"),results:$("#search-results")},init:function(){$("#alert").hide(),t.exports.initEvents()},initEvents:function(){$(".import").off(),$("#search").off(),$("#search").click(function(e){e.preventDefault();var n=t.exports.settings.userInput.val();n.length>3&&t.exports.playerSearch(n).then(function(e){t.exports.displaySearchData(e)}).catch(function(){t.exports.displayAlert("Error pulling search data.","danger")})}),$(".import").click(function(e){e.preventDefault(),r.getPlayerdata($(this).data("id")).then(function(e){var n=i(e);t.exports.submitPlayerData(n)}).catch(function(){t.exports.displayAlert("Error with player data.","danger")})})},playerSearch:function(e){return t.exports.settings.results.empty(),r.searchFor("characters",e)},displaySearchData:function(e){$.each(e.characters.results,function(e,n){t.exports.settings.results.append($("<tr>").append($('<th scope="row" class="d-none d-sm-table-cell">').text(e+1),$("<td>").append($("<img src="+n.icon+">")),$("<td>").text(n.name),$('<td class="d-none d-sm-table-cell">').text(n.server),$("<td>").append($('<button class="btn btn-secondary import" data-id="'+n.id+'">').text("Import"))))}),t.exports.initEvents()},submitPlayerData:function(e){return s("/api/player/add",e).then(function(){t.exports.displayAlert("Player added.","success")}).catch(function(){t.exports.displayAlert("Error saving player data.","danger")})},displayAlert:function(t,e){$("#alert-content").text(t),$("#alert").addClass("alert-"+e).show()}},t.exports.init()},function(t,e,n){"use strict";t.exports={settings:{url:"http://api.xivdb.com/",rateLimit:5},searchFor:function(e,n){return e=void 0!==e?e:"",n=void 0!==n?n:"",n=encodeURI(n),fetch(t.exports.settings.url+"search?string="+n+"&one="+e).then(function(t){return t.json()})},getItemData:function(e,n){return fetch(t.exports.settings.url+"item/"+e).then(function(t){return t.json()})},getPlayerdata:function(e,n){return n=void 0!==n?"?data="+n:"",fetch(t.exports.settings.url+"character/"+e).then(function(t){return t.json()})}}},function(t,e,n){"use strict";t.exports={settings:{},toPlayerObj:function(t){return{name:t.data.name,gender:"male"===t.data.gender?0:1,avatar:t.data.avatar,server:t.data.server,portrait:t.data.portrait,loadstone_id:t.lodestone_id}}}}]);
//# sourceMappingURL=player.js.map